/* Driver.js custom theme — Pollar liquid glass effect
   Matches TooltipContent & DropdownMenuContent from ui/ components.

   IMPORTANT: popoverClass adds "pollar-tour" to the SAME element as
   "driver-popover", so the container selector must be compound (dot-joined),
   not descendant (space-separated). Child elements use descendant selectors.

   ═══════════════════════════════════════════════════════════════════════════
   DRIVER.JS DEFAULT CSS — FULL NEUTRALIZATION
   The library ships aggressive defaults that break dark themes and mobile
   layouts. Every problematic rule is listed below with its override.
   ═══════════════════════════════════════════════════════════════════════════

   PROBLEM 1 — .driver-popover { all:unset; background-color:#fff; color:#2d2d2d }
     White bg, dark text. Fixed by compound selector on container.

   PROBLEM 2 — .driver-popover * { font-family: Helvetica Neue, Inter, ... }
     Overrides project font (HK Grotesk). Fixed by font-family override.

   PROBLEM 3 — .driver-popover-title { font: 19px/normal sans-serif }
   PROBLEM 4 — .driver-popover-description { font: 14px/normal sans-serif }
     `font` shorthand resets font-family. Fixed by re-declaring font props.

   PROBLEM 5 — .driver-popover-footer button { all:unset; background-color:#fff;
               color:#2d2d2d; text-shadow:1px 1px 0 #fff; font:12px/normal sans-serif }
     White buttons, white text-shadow (ghosting on dark bg). Fixed below.

   PROBLEM 6 — .driver-popover-footer button:hover { background-color:#f7f7f7 }
     Light hover. Fixed below.

   PROBLEM 7 — .driver-popover-close-btn { color:#d2d2d2 }
               .driver-popover-close-btn:hover { color:#2d2d2d }
     Dark hover color invisible on dark bg. Fixed below.

   PROBLEM 8 — :not(body):has(>.driver-active-element) { overflow:hidden!important }
     Forces overflow:hidden on parents of highlighted element. Breaks mobile
     layouts (horizontal scrollers, event page width). Fixed below.

   PROBLEM 9 — .driver-popover-arrow { border: 5px solid #fff }
     White arrow. We hide it entirely (matching Header tooltips).

   PROBLEM 10 — .driver-overlay path { opacity set via inline style }
     Inline opacity affects stroke too. Fixed via !important override.
   ═══════════════════════════════════════════════════════════════════════════ */


/* ══ KEYFRAMES ════════════════════════════════════════════════════════════ */

@keyframes pollar-popover-in {
  from {
    opacity: 0;
    transform: translateY(6px) scale(0.97);
  }
  to {
    opacity: 1;
    transform: translateY(0) scale(1);
  }
}

@keyframes pollar-stage-pulse {
  0%, 100% {
    stroke-opacity: 0.85;
  }
  50% {
    stroke-opacity: 0.45;
  }
}


/* ══ GLOBAL FIXES (not scoped to popoverClass) ════════════════════════════ */

/* PROBLEM 8 — overflow:hidden on parents breaks mobile layout */
:not(body):has(> .driver-active-element) {
  overflow: visible !important;
}

/* PROBLEM 10 — SVG overlay: red stroke on cutout, dark fill with own alpha */
.driver-overlay path {
  opacity: 1 !important;
  fill: rgba(0, 0, 0, 0.75) !important;
  stroke: rgb(239, 68, 68);
  stroke-width: 3;
  paint-order: stroke fill;
  animation: pollar-stage-pulse 2.5s ease-in-out infinite;
}

/* Smooth cutout transition when moving between steps */
.driver-overlay {
  transition: all 300ms ease-out;
}


/* ══ POPOVER CONTAINER (compound selector — same element) ═════════════════ */

/* PROBLEM 1 — white background → liquid glass */
.driver-popover.pollar-tour {
  background: rgba(24, 24, 27, 0.7);
  backdrop-filter: blur(24px) saturate(1.5);
  -webkit-backdrop-filter: blur(24px) saturate(1.5);
  border: 1px solid rgba(255, 255, 255, 0.1);
  box-shadow:
    0 0 0 1px rgba(255, 255, 255, 0.05),
    0 20px 25px -5px rgba(0, 0, 0, 0.3),
    0 8px 10px -6px rgba(0, 0, 0, 0.3);
  color: #f4f4f5;
  border-radius: 0.75rem;
  max-width: 320px;
  /* Subtle entrance — slide up + scale */
  animation: pollar-popover-in 300ms cubic-bezier(0.22, 1, 0.36, 1) both;
  /* Smooth fade when hiding during scroll-to-header transitions */
  transition: opacity 200ms ease;
}

/* PROBLEM 2 — wrong font-family on all children */
.driver-popover.pollar-tour,
.driver-popover.pollar-tour * {
  font-family: 'HK Grotesk', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
}

/* PROBLEM 9 — white arrow → hidden */
.driver-popover.pollar-tour .driver-popover-arrow {
  display: none;
}


/* ══ TYPOGRAPHY (descendant selectors — children of popover) ══════════════ */

/* PROBLEM 3 — title font shorthand resets font-family */
.pollar-tour .driver-popover-title {
  font: unset;
  font-weight: 600;
  font-size: 0.875rem;
  line-height: 1.5;
  color: #f4f4f5;
  letter-spacing: -0.01em;
  transition: opacity 200ms ease;
}

/* PROBLEM 4 — description font shorthand resets font-family */
.pollar-tour .driver-popover-description {
  font: unset;
  font-size: 0.75rem;
  font-weight: 400;
  line-height: 1.5;
  color: #a1a1aa;
  transition: opacity 200ms ease;
}

.pollar-tour .driver-popover-progress-text {
  color: #71717a;
  font-size: 0.6875rem;
  transition: opacity 150ms ease;
}


/* ══ BUTTONS ══════════════════════════════════════════════════════════════ */

/* PROBLEM 5 — footer buttons: white bg, text-shadow, wrong font */
.pollar-tour .driver-popover-footer button {
  all: unset;
  display: inline-block;
  box-sizing: border-box;
  cursor: pointer;
  font-family: inherit;
  font-size: 0.75rem;
  font-weight: 500;
  line-height: 1.3;
  padding: 0.375rem 0.75rem;
  border-radius: 0.5rem;
  border: 1px solid rgba(255, 255, 255, 0.1);
  background: transparent;
  color: #a1a1aa;
  text-shadow: none;
  transition: background 150ms, color 150ms;
}

/* PROBLEM 6 — light hover color */
.pollar-tour .driver-popover-footer button:hover,
.pollar-tour .driver-popover-footer button:focus {
  background: rgba(255, 255, 255, 0.1);
  color: #fff;
}

.pollar-tour .driver-popover-footer .driver-popover-btn-disabled {
  opacity: 0.5;
  pointer-events: none;
}

.pollar-tour .driver-popover-navigation-btns {
  gap: 0.5rem;
}

/* Next / Done — slightly brighter to stand out */
.pollar-tour .driver-popover-next-btn,
.pollar-tour .driver-popover-close-btn-text {
  background: rgba(255, 255, 255, 0.1);
  color: #fff;
}

.pollar-tour .driver-popover-next-btn:hover,
.pollar-tour .driver-popover-close-btn-text:hover {
  background: rgba(255, 255, 255, 0.15);
}


/* ══ CLOSE (X) BUTTON ════════════════════════════════════════════════════ */

/* PROBLEM 7 — dark hover color invisible on dark bg */
.pollar-tour .driver-popover-close-btn {
  color: #71717a;
  transition: color 150ms;
}

.pollar-tour .driver-popover-close-btn:hover,
.pollar-tour .driver-popover-close-btn:focus {
  color: #f4f4f5;
}
